var $url="/pages/cms/editorLayerImage",$urlUpload=apiUrl+"/pages/cms/editorLayerImage/actions/upload?siteId="+utils.getQueryInt("siteId")+"&channelId="+utils.getQueryInt("channelId"),data={attributeName:utils.getQueryString("attributeName"),pageLoad:!1,pageAlert:null,uploadList:[],dialogImageUrl:"",dialogVisible:!1,form:{siteId:utils.getQueryInt("siteId"),channelId:utils.getQueryInt("channelId"),isThumb:!1,thumbWidth:500,thumbHeight:500,isLinkToOriginal:!0,filePaths:[]}},methods={insert:function(e){var t='<img src="'+e.imageUrl+'" style="border: 0; max-width: 100%" />';if(e.previewUrl){var i='<el-image src="'+e.imageUrl+'" style="border: 0; max-width: 100%"></el-image>';t='<img data-vue="'+encodeURIComponent(i)+'" src="'+e.imageUrl+'" style="border: 0; max-width: 100%" />'}parent.insertHtml(this.attributeName,t)},btnSubmitClick:function(){var e=this;if(0===this.form.filePaths.length)return this.$message.error("请选择需要插入的图片文件！"),!1;utils.loading(!0),$api.post($url,this.form).then(function(t){var i=t.data;if(i&&i.length>0)for(var a=0;a<i.length;a++){var r=i[a];e.insert(r)}parent.layer.closeAll()}).catch(function(t){e.pageAlert=utils.getPageAlert(t)}).then(function(){utils.loading(!1)})},btnCancelClick:function(){parent.layer.closeAll()},uploadBefore(e){return/(\.jpg|\.jpeg|\.bmp|\.gif|\.png|\.webp)$/i.exec(e.name)?!!(e.size/1024/1024<10)||(this.$message.error("上传图片大小不能超过 10MB!"),!1):(this.$message.error("文件只能是图片格式，请选择有效的文件上传!"),!1)},uploadProgress:function(){utils.loading(!0)},uploadSuccess:function(e){this.form.filePaths.push(e.path),utils.loading(!1)},uploadError:function(e){utils.loading(!1);var t=JSON.parse(e.message);this.$message.error(t.message)},uploadRemove(e){e.response&&this.form.filePaths.splice(this.form.filePaths.indexOf(e.response.path),1)},uploadPictureCardPreview(e){this.dialogImageUrl=e.url,this.dialogVisible=!0}};new Vue({el:"#main",data:data,methods:methods,created:function(){this.pageLoad=!0}});