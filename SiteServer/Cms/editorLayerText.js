var $url="/pages/cms/editorLayerText",data={attributeName:utils.getQueryString("attributeName"),siteId:utils.getQueryInt("siteId"),pageLoad:!1,pageType:"card",groups:null,count:null,items:null,urlList:null,renameId:0,renameTitle:"",deleteId:0,selectedGroupId:0,form:{siteId:utils.getQueryInt("siteId"),keyword:"",groupId:0,page:1,perPage:24},isSubmitForm:!1,submitForm:{textId:0,type:"click",linkText:"详细说明"}},methods={insert:function(){var t='<img src="../assets/editor-images/library.png" type="text" id="'+this.submitForm.textId+'">';"click"===this.submitForm.type&&(t='<el-popover  width="600"  trigger="click">  '+t+'  <a href="javascript:;" slot="reference">'+this.submitForm.linkText+"</a></el-popover>");parent.insertHtml(this.attributeName,t)},apiList:function(t){var i=this;this.form.page=t,$api.post($url+"/list",this.form).then(function(t){var e=t.data;i.groups=e.groups,i.count=e.count,i.items=e.items,i.urlList=_.map(i.items,function(t){return t.imageUrl})}).catch(function(t){utils.notifyError(i,t)}).then(function(){i.pageLoad=!0,utils.loading(!1)})},getGroupName:function(){var t=this;return this.form.groupId>0?_.find(this.groups,function(i){return i.id===t.form.groupId}).groupName:""},btnSelectClick:function(t){this.isSubmitForm=!0,this.submitForm.textId=t.id},btnSelectGroupClick:function(t){this.selectedGroupId=this.selectedGroupId===t?0:t},btnGroupClick:function(t){var i=this;this.form.groupId=t,this.form.page=1,utils.loading(!0),$api.post($url+"/list",this.form).then(function(t){var e=t.data;i.groups=e.groups,i.count=e.count,i.items=e.items,i.urlList=_.map(i.items,function(t){return t.imageUrl})}).catch(function(t){i.$notify.error({title:"错误",message:t.message})}).then(function(){i.pageLoad=!0,utils.loading(!1)})},btnDropdownClick:function(t){this.pageType=t},btnSubmitClick:function(){var t=this;this.$refs.submitForm.validate(function(i){if(!i)return!1;utils.loading(!0),t.insert(),t.isSubmitForm=!1,utils.closeLayer()})},btnSearchClick(){utils.loading(!0),this.apiList(1)},btnPageClick:function(t){utils.loading(!0),this.apiList(t)}};new Vue({el:"#main",data:data,methods:methods,created:function(){this.apiList(1)}});