var $url="/pages/cms/libraryLayerWord",$urlUpload=apiUrl+"/pages/cms/libraryLayerWord/actions/upload?siteId="+utils.getQueryInt("siteId"),data={pageLoad:!1,pageAlert:null,uploadList:[],form:{siteId:utils.getQueryInt("siteId"),isClearFormat:!0,isFirstLineIndent:!0,isClearFontSize:!0,isClearFontFamily:!0,isClearImages:!1,fileNames:[]}},methods={btnSubmitClick:function(){var e=this;if(0===this.form.fileNames.length)return this.$message.error("请选择需要导入的Word文件！"),!1;utils.loading(!0),$api.post($url,this.form).then(function(e){var a=e.data;parent.insertHtml(a.value),parent.layer.closeAll()}).catch(function(a){e.pageAlert=utils.getPageAlert(a)}).then(function(){utils.loading(!1)})},btnCancelClick:function(){parent.layer.closeAll()},uploadBefore(e){return!!/(\.doc|\.docx|\.wps)$/i.exec(e.name)||(this.$message.error("文件只能是 Word 格式，请选择有效的文件上传!"),!1)},uploadProgress:function(){utils.loading(!0)},uploadRemove(e){e.response&&this.form.fileNames.splice(this.form.fileNames.indexOf(e.response.name),1)},uploadSuccess:function(e){this.form.fileNames.push(e.name),utils.loading(!1)},uploadError:function(e){utils.loading(!1);var a=JSON.parse(e.message);this.$message.error(a.message)}};new Vue({el:"#main",data:data,methods:methods,created:function(){this.pageLoad=!0}});