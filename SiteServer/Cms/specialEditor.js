var $api=new apiUtils.Api(apiUrl+"/pages/cms/specialEditor"),data={siteId:parseInt(pageUtils.getQueryString("siteId")),specialId:parseInt(pageUtils.getQueryString("specialId")),pageLoad:!1,pageAlert:null,items:null,specialInfo:null,specialUrl:null,headHtml:null,bodyHtml:null},methods={clear:function(e){for(var t,a=/<script\b[^>]*>([\s\S]*?)<\/script>/gm;t=a.exec(e);)e=e.replace(t[0],"");return e},getStyleSheets:function(e){for(var t,a=[],l=/<link.+?href=\"(.+\.css)\".*?>/;t=l.exec(e);){var i=this.specialUrl+"/"+t[1];a.push(i),e=e.replace(t[0],"")}return a},getConfig:function(){var e=this;$api.get({siteId:this.siteId,specialId:this.specialId},function(t,a){if(!t&&a&&a.value){if(e.specialInfo=a.value,e.specialUrl=a.specialUrl,a.html){e.bodyHtml=e.clear(e.clear(e.clear(e.clear(/<body[^>]*>((.|[\n\r])*)<\/body>/im.exec(a.html)[1]))));for(var l=e.getStyleSheets(a.html),i=document.getElementsByTagName("head").item(0),r=0;r<l.length;r++){var s=document.createElement("link");s.setAttribute("rel","stylesheet"),s.setAttribute("type","text/css"),s.setAttribute("href",l[r]),i.appendChild(s)}}e.pageLoad=!0,setTimeout(function(){e.load()},100)}})},load:function(){new FroalaEditor("textarea")}};new Vue({el:"#main",data:data,methods:methods,created:function(){this.getConfig()}});