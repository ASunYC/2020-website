!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("froala-editor")):"function"==typeof define&&define.amd?define(["froala-editor"],t):t(e.FroalaEditor)}(this,function(e){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e,Object.assign(e.DEFAULTS,{lineBreakerTags:["table","hr","form","dl","span.fr-video",".fr-embedly","img"],lineBreakerOffset:15,lineBreakerHorizontalOffset:10}),e.PLUGINS.lineBreaker=function(t){var r,n,a,o=t.$;function i(e,n){var a,i,s,f,l,p,u,g;if(null==e)l=(f=n.parent()).offset().top,a=(u=n.offset().top)-Math.min((u-l)/2,t.opts.lineBreakerOffset),s=f.outerWidth(),i=f.offset().left;else if(null==n)(p=(f=e.parent()).offset().top+f.outerHeight())<(g=e.offset().top+e.outerHeight())&&(p=(f=o(f).parent()).offset().top+f.outerHeight()),a=g+Math.min(Math.abs(p-g)/2,t.opts.lineBreakerOffset),s=f.outerWidth(),i=f.offset().left;else{f=e.parent();var d=e.offset().top+e.height(),c=n.offset().top;if(c<d)return!1;a=(d+c)/2,s=f.outerWidth(),i=f.offset().left}if(t.opts.iframe){var v=t.helpers.getPX(t.$wp.find(".fr-iframe").css("padding-top")),m=t.helpers.getPX(t.$wp.find(".fr-iframe").css("padding-left"));i+=t.$iframe.offset().left-t.helpers.scrollLeft()+m,a+=t.$iframe.offset().top-t.helpers.scrollTop()+v}t.$box.append(r),r.css("top",a-t.win.pageYOffset),r.css("left",i-t.win.pageXOffset),r.css("width",s),r.data("tag1",e),r.data("tag2",n),r.addClass("fr-visible").data("instance",t)}function s(e){if(e){var r=o(e);if(0===t.$el.find(r).length)return null;if(e.nodeType!=Node.TEXT_NODE&&r.is(t.opts.lineBreakerTags.join(",")))return r;if(0<r.parents(t.opts.lineBreakerTags.join(",")).length)return e=r.parents(t.opts.lineBreakerTags.join(",")).get(0),0!==t.$el.find(o(e)).length&&o(e).is(t.opts.lineBreakerTags.join(","))?o(e):null}return null}function f(e,r){var n=t.doc.elementFromPoint(e,r);return n&&!o(n).closest(".fr-line-breaker").length&&!t.node.isElement(n)&&n!=t.$wp.get(0)&&function(e){if(void 0!==e.inFroalaWrapper)return e.inFroalaWrapper;for(var r=e;e.parentNode&&e.parentNode!==t.$wp.get(0);)e=e.parentNode;return r.inFroalaWrapper=e.parentNode==t.$wp.get(0),r.inFroalaWrapper}(n)?n:null}function l(e,r,n){for(var a=n,o=null;a<=t.opts.lineBreakerOffset&&!o;)(o=f(e,r-a))||(o=f(e,r+a)),a+=n;return o}function p(e,r,n){for(var a=null,o=100;!a&&e>t.$box.offset().left&&e<t.$box.offset().left+t.$box.outerWidth()&&0<o;)(a=f(e,r))||(a=l(e,r,5)),"left"==n?e-=t.opts.lineBreakerHorizontalOffset:e+=t.opts.lineBreakerHorizontalOffset,o-=t.opts.lineBreakerHorizontalOffset;return a}function u(e){var n=a=null,o=null,f=t.doc.elementFromPoint(e.pageX-t.win.pageXOffset,e.pageY-t.win.pageYOffset);(n=f&&("HTML"==f.tagName||"BODY"==f.tagName||t.node.isElement(f)||0<=(f.getAttribute("class")||"").indexOf("fr-line-breaker"))?((o=l(e.pageX-t.win.pageXOffset,e.pageY-t.win.pageYOffset,1))||(o=p(e.pageX-t.win.pageXOffset-t.opts.lineBreakerHorizontalOffset,e.pageY-t.win.pageYOffset,"left")),o||(o=p(e.pageX-t.win.pageXOffset+t.opts.lineBreakerHorizontalOffset,e.pageY-t.win.pageYOffset,"right")),s(o)):s(f))?function(e,n){var a,o,f=e.offset().top,l=e.offset().top+e.outerHeight();if(Math.abs(l-n)<=t.opts.lineBreakerOffset||Math.abs(n-f)<=t.opts.lineBreakerOffset)if(Math.abs(l-n)<Math.abs(n-f)){for(var p=(o=e.get(0)).nextSibling;p&&p.nodeType==Node.TEXT_NODE&&0===p.textContent.length;)p=p.nextSibling;if(!p)return i(e,null),!0;if(a=s(p))return i(e,a),!0}else{if(!(o=e.get(0)).previousSibling)return i(null,e),!0;if(a=s(o.previousSibling))return i(a,e),!0}r.removeClass("fr-visible").removeData("instance")}(n,e.pageY):t.core.sameInstance(r)&&r.removeClass("fr-visible").removeData("instance")}function g(e){return!(r.hasClass("fr-visible")&&!t.core.sameInstance(r))&&(t.popups.areVisible()||t.el.querySelector(".fr-selected-cell")?(r.removeClass("fr-visible"),!0):void(!1!==n||t.edit.isDisabled()||(a&&clearTimeout(a),a=setTimeout(u,30,e))))}function d(){a&&clearTimeout(a),r&&r.hasClass("fr-visible")&&r.removeClass("fr-visible").removeData("instance")}function c(){n=!0,d()}function v(){n=!1}function m(n){n.preventDefault();var a=r.data("instance")||t;r.removeClass("fr-visible").removeData("instance");var o=r.data("tag1"),i=r.data("tag2"),s=t.html.defaultTag();null==o?s&&"TD"!=i.parent().get(0).tagName&&0===i.parents(s).length?i.before("<"+s+">"+e.MARKERS+"<br></"+s+">"):i.before(e.MARKERS+"<br>"):s&&"TD"!=o.parent().get(0).tagName&&0===o.parents(s).length?o.after("<"+s+">"+e.MARKERS+"<br></"+s+">"):o.after(e.MARKERS+"<br>"),a.selection.restore(),t.toolbar.enable()}return{_init:function(){if(!t.$wp)return!1;t.shared.$line_breaker||(t.shared.$line_breaker=o(document.createElement("div")).attr("class","fr-line-breaker").html('<a class="fr-floating-btn" role="button" tabIndex="-1" title="'+t.language.translate("Break")+'"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><rect x="17" y="7" width="2" height="8"/><rect x="10" y="13" width="7" height="2"/><path d="M10.000,10.000 L10.000,18.013 L5.000,14.031 L10.000,10.000 Z"/></svg></a>')),r=t.shared.$line_breaker,t.events.on("shared.destroy",function(){r.html("").removeData().remove(),r=null},!0),t.events.on("destroy",function(){r.removeData("instance").removeClass("fr-visible"),o("body").first().append(r),clearTimeout(a)},!0),t.events.$on(r,"mousemove",function(e){e.stopPropagation()},!0),t.events.bindClick(r,"a",m),n=!1,t.events.$on(t.$win,"mousemove",g),t.events.$on(o(t.win),"scroll",d),t.events.on("popups.show.table.edit",d),t.events.on("commands.after",d),t.events.$on(o(t.win),"mousedown",c),t.events.$on(o(t.win),"mouseup",v)}}}});