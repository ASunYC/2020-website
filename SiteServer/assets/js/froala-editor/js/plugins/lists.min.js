!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("froala-editor")):"function"==typeof define&&define.amd?define(["froala-editor"],t):t(e.FroalaEditor)}(this,function(e){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e,Object.assign(e.DEFAULTS,{listAdvancedTypes:!0}),e.PLUGINS.lists=function(t){var a=t.$;function n(e){return'<span class="fr-open-'+e.toLowerCase()+'"></span>'}function r(e){return'<span class="fr-close-'+e.toLowerCase()+'"></span>'}function i(e){var i,s;for(i=e.length-1;0<=i;i--)for(s=i-1;0<=s;s--)if(a(e[s]).find(e[i]).length||e[s]==e[i]){e.splice(i,1);break}var o=[];for(i=0;i<e.length;i++){var l=a(e[i]),f=e[i].parentNode,p=l.attr("class");if(l.before(r(f.tagName)),"LI"==f.parentNode.tagName)l.before(r("LI")),l.after(n("LI"));else{var d="";p&&(d+=' class="'+p+'"');var c="rtl"==t.opts.direction||"rtl"==l.css("direction")?"margin-right":"margin-left";t.helpers.getPX(a(f).css(c))&&0<=(a(f).attr("style")||"").indexOf(c+":")&&(d+=' style="'+c+":"+t.helpers.getPX(a(f).css(c))+'px;"'),t.html.defaultTag()&&0===l.find(t.html.blockTagsQuery()).length&&l.wrapInner(t.html.defaultTag()+d),t.node.isEmpty(l.get(0),!0)||0!==l.find(t.html.blockTagsQuery()).length||l.append("<br>"),l.append(n("LI")),l.prepend(r("LI"))}l.after(n(f.tagName)),"LI"==f.parentNode.tagName&&(f=f.parentNode.parentNode),o.indexOf(f)<0&&o.push(f)}for(i=0;i<o.length;i++){var g=a(o[i]),m=g.html();m=(m=m.replace(/<span class="fr-close-([a-z]*)"><\/span>/g,"</$1>")).replace(/<span class="fr-open-([a-z]*)"><\/span>/g,"<$1>"),g.replaceWith(t.node.openTagString(g.get(0))+m+t.node.closeTagString(g.get(0)))}t.$el.find("li:empty").remove(),t.$el.find("ul:empty, ol:empty").remove(),t.clean.lists(),t.html.wrap()}function s(e){t.selection.save();for(var n=0;n<e.length;n++){var r=e[n].previousSibling;if(r){var i=a(e[n]).find("> ul, > ol").last().get(0);if(i){var s=a(document.createElement("li"));a(i).prepend(s);for(var o=t.node.contents(e[n])[0];o&&!t.node.isList(o);){var l=o.nextSibling;s.append(o),o=l}a(r).append(a(i)),a(e[n]).remove()}else{var f=a(r).find("> ul, > ol").last().get(0);if(f)a(f).append(a(e[n]));else{var p=a("<"+e[n].parentNode.tagName+">");a(r).append(p),p.append(a(e[n]))}}}}t.clean.lists(),t.selection.restore()}function o(e){t.selection.save(),i(e),t.selection.restore()}function l(e){if("indent"==e||"outdent"==e){var a=!1,n=t.selection.blocks(),r=[],i=n[0].previousSibling||n[0].parentElement;if("outdent"==e){if("LI"==i.tagName||"LI"!=i.parentNode.tagName)return}else if(!n[0].previousSibling||"LI"!=n[0].previousSibling.tagName)return;for(var l=0;l<n.length;l++)"LI"==n[l].tagName?(a=!0,r.push(n[l])):"LI"==n[l].parentNode.tagName&&(a=!0,r.push(n[l].parentNode));a&&("indent"==e?s(r):o(r))}}return{_init:function(){t.events.on("commands.after",l),t.events.on("keydown",function(a){if(a.which==e.KEYCODE.TAB){for(var n=t.selection.blocks(),r=[],i=0;i<n.length;i++)"LI"==n[i].tagName?r.push(n[i]):"LI"==n[i].parentNode.tagName&&r.push(n[i].parentNode);if(1<r.length||r.length&&(t.selection.info(r[0]).atStart||t.node.isEmpty(r[0])))return a.preventDefault(),a.stopPropagation(),a.shiftKey?o(r):s(r),!1}},!0)},format:function(e,n){var r,s;for(t.selection.save(),t.html.wrap(!0,!0,!0,!0),t.selection.restore(),s=t.selection.blocks(),r=0;r<s.length;r++)"LI"!=s[r].tagName&&"LI"==s[r].parentNode.tagName&&(s[r]=s[r].parentNode);if(t.selection.save(),function(e,t){for(var a=!0,n=0;n<e.length;n++){if("LI"!=e[n].tagName)return!1;e[n].parentNode.tagName!=t&&(a=!1)}return a}(s,e)?n||i(s):function(e,n){!function(e,n){for(var r=[],i=0;i<e.length;i++){var s=e[i].parentNode;"LI"==e[i].tagName&&s.tagName!=n&&r.indexOf(s)<0&&r.push(s)}for(var o=r.length-1;0<=o;o--){var l=a(r[o]);l.replaceWith("<"+n.toLowerCase()+" "+t.node.attributes(l.get(0))+">"+l.html()+"</"+n.toLowerCase()+">")}}(e,n);var r,i=t.html.defaultTag(),s=null;e.length&&(r="rtl"==t.opts.direction||"rtl"==a(e[0]).css("direction")?"margin-right":"margin-left");for(var o=0;o<e.length;o++)if("TD"!=e[o].tagName&&"TH"!=e[o].tagName&&"LI"!=e[o].tagName){var l=t.helpers.getPX(a(e[o]).css(r))||0;(e[o].style.marginLeft=null)===s&&(s=l);var f=0<s?"<"+n+' style="'+r+": "+s+'px ">':"<"+n+">",p="</"+n+">";for(l-=s;0<l/t.opts.indentMargin;)f+="<"+n+">",p+=p,l-=t.opts.indentMargin;i&&e[o].tagName.toLowerCase()==i?a(e[o]).replaceWith(f+"<li"+t.node.attributes(e[o])+">"+a(e[o]).html()+"</li>"+p):a(e[o]).wrap(f+"<li></li>"+p)}t.clean.lists()}(s,e),t.html.unwrap(),t.selection.restore(),n=n||"default"){for(s=t.selection.blocks(),r=0;r<s.length;r++)"LI"!=s[r].tagName&&"LI"==s[r].parentNode.tagName&&(s[r]=s[r].parentNode);for(r=0;r<s.length;r++)"LI"==s[r].tagName&&(a(s[r].parentNode).css("list-style-type","default"===n?"":n),0===(a(s[r].parentNode).attr("style")||"").length&&a(s[r].parentNode).removeAttr("style"))}},refresh:function(e,n){var r=a(t.selection.element());if(r.get(0)!=t.el){var i=r.get(0);(i="LI"!=i.tagName&&i.firstElementChild&&"LI"!=i.firstElementChild.tagName?r.parents("li").get(0):"LI"==i.tagName||i.firstElementChild?i.firstElementChild&&"LI"==i.firstElementChild.tagName?r.get(0).firstChild:r.get(0):r.parents("li").get(0))&&i.parentNode.tagName==n&&t.el.contains(i.parentNode)&&e.addClass("fr-active")}}}},e.DefineIcon("formatOLSimple",{NAME:"list-ol",SVG_KEY:"orderedList"}),e.RegisterCommand("formatOLSimple",{title:"Ordered List",type:"button",options:{default:"Default",circle:"Circle",disc:"Disc",square:"Square"},refresh:function(e){this.lists.refresh(e,"OL")},callback:function(e,t){this.lists.format("OL",t)},plugin:"lists"}),e.RegisterCommand("formatUL",{title:"Unordered List",type:"button",hasOptions:function(){return this.opts.listAdvancedTypes},options:{default:"Default",circle:"Circle",disc:"Disc",square:"Square"},refresh:function(e){this.lists.refresh(e,"UL")},callback:function(e,t){this.lists.format("UL",t)},plugin:"lists"}),e.RegisterCommand("formatOL",{title:"Ordered List",hasOptions:function(){return this.opts.listAdvancedTypes},options:{default:"Default","lower-alpha":"Lower Alpha","lower-greek":"Lower Greek","lower-roman":"Lower Roman","upper-alpha":"Upper Alpha","upper-roman":"Upper Roman"},refresh:function(e){this.lists.refresh(e,"OL")},callback:function(e,t){this.lists.format("OL",t)},plugin:"lists"}),e.DefineIcon("formatUL",{NAME:"list-ul",SVG_KEY:"unorderedList"}),e.DefineIcon("formatOL",{NAME:"list-ol",SVG_KEY:"orderedList"})});