!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("froala-editor")):"function"==typeof define&&define.amd?define(["froala-editor"],e):e(t.FroalaEditor)}(this,function(t){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t,Object.assign(t.POPUP_TEMPLATES,{"forms.edit":"[_BUTTONS_]","forms.update":"[_BUTTONS_][_TEXT_LAYER_]"}),Object.assign(t.DEFAULTS,{formEditButtons:["inputStyle","inputEdit"],formStyles:{"fr-rounded":"Rounded","fr-large":"Large"},formMultipleStyles:!0,formUpdateButtons:["inputBack","|"]}),t.PLUGINS.forms=function(t){var e,o=t.$;function n(e){e.preventDefault(),t.selection.clear(),o(this).data("mousedown",!0)}function a(t){o(this).data("mousedown")&&(t.stopPropagation(),o(this).removeData("mousedown"),u(e=this)),t.preventDefault()}function s(){t.$el.find("input, textarea, button").removeData("mousedown")}function i(){o(this).removeData("mousedown")}function r(){return e||null}function u(n){var a=t.popups.get("forms.edit");a||(a=function(){var e="";0<t.opts.formEditButtons.length&&(e='<div class="fr-buttons">'.concat(t.button.buildList(t.opts.formEditButtons),"</div>"));var o={buttons:e},n=t.popups.create("forms.edit",o);return t.$wp&&t.events.$on(t.$wp,"scroll.link-edit",function(){r()&&t.popups.isVisible("forms.edit")&&u(r())}),n}());var s=o(e=n);t.popups.refresh("forms.edit"),t.popups.setContainer("forms.edit",t.$sc);var i=s.offset().left+s.outerWidth()/2,p=s.offset().top+s.outerHeight();t.popups.show("forms.edit",i,p,s.outerHeight())}function p(){var e=t.popups.get("forms.update"),n=r();if(n){var a=o(n);a.is("button")?e.find('input[type="text"][name="text"]').val(a.text()):e.find('input[type="text"][name="text"]').val(a.attr("placeholder"))}e.find('input[type="text"][name="text"]').trigger("change")}function f(){e=null}function d(e){if(e)return t.popups.onRefresh("forms.update",p),t.popups.onHide("forms.update",f),!0;var o="";1<=t.opts.formUpdateButtons.length&&(o='<div class="fr-buttons">'.concat(t.button.buildList(t.opts.formUpdateButtons),"</div>"));var n=0,a={buttons:o,text_layer:'<div class="fr-forms-text-layer fr-layer fr-active"> \n    <div class="fr-input-line"><input name="text" type="text" placeholder="Text" tabIndex=" '.concat(++n,' "></div>\n    <div class="fr-action-buttons"><button class="fr-command fr-submit" data-cmd="updateInput" href="#" tabIndex="').concat(2,'" type="button">').concat(t.language.translate("Update"),"</button></div></div>")};return t.popups.create("forms.update",a)}return{_init:function(){t.events.$on(t.$el,t._mousedown,"input, textarea, button",n),t.events.$on(t.$el,t._mouseup,"input, textarea, button",a),t.events.$on(t.$el,"touchmove","input, textarea, button",i),t.events.$on(t.$el,t._mouseup,s),t.events.$on(t.$win,t._mouseup,s),d(!0),t.events.$on(t.$el,"submit","form",function(t){return t.preventDefault(),!1})},updateInput:function(){var e=t.popups.get("forms.update"),n=r();if(n){var a=o(n),s=e.find('input[type="text"][name="text"]').val()||"";s.length&&(a.is("button")?a.text(s):a.attr("placeholder",s)),t.popups.hide("forms.update"),u(n)}},getInput:r,applyStyle:function(e,n,a){void 0===n&&(n=t.opts.formStyles),void 0===a&&(a=t.opts.formMultipleStyles);var s=r();if(!s)return!1;if(!a){var i=Object.keys(n);i.splice(i.indexOf(e),1),o(s).removeClass(i.join(" "))}o(s).toggleClass(e)},showUpdatePopup:function(){var e=r();if(e){var n=o(e),a=t.popups.get("forms.update");a||(a=d()),t.popups.isVisible("forms.update")||t.popups.refresh("forms.update"),t.popups.setContainer("forms.update",t.$sc);var s=n.offset().left+n.outerWidth()/2,i=n.offset().top+n.outerHeight();t.popups.show("forms.update",s,i,n.outerHeight())}},showEditPopup:u,back:function(){t.events.disableBlur(),t.selection.restore(),t.events.enableBlur();var e=r();e&&t.$wp&&("BUTTON"===e.tagName&&t.selection.restore(),u(e))}}},t.RegisterCommand("updateInput",{undo:!1,focus:!1,title:"Update",callback:function(){this.forms.updateInput()}}),t.DefineIcon("inputStyle",{NAME:"magic",SVG_KEY:"inlineStyle"}),t.RegisterCommand("inputStyle",{title:"Style",type:"dropdown",html:function(){var t='<ul class="fr-dropdown-list">',e=this.opts.formStyles;for(var o in e)e.hasOwnProperty(o)&&(t+='<li><a class="fr-command" tabIndex="-1" data-cmd="inputStyle" data-param1="'.concat(o,'">').concat(this.language.translate(e[o]),"</a></li>"));return t+"</ul>"},callback:function(t,e){var o=this.forms.getInput();o&&(this.forms.applyStyle(e),this.forms.showEditPopup(o))},refreshOnShow:function(t,e){var o=this.$,n=this.forms.getInput();if(n){var a=o(n);e.find(".fr-command").each(function(){var t=o(this).data("param1");o(this).toggleClass("fr-active",a.hasClass(t))})}}}),t.DefineIcon("inputEdit",{NAME:"edit"}),t.RegisterCommand("inputEdit",{title:"Edit Button",undo:!1,refreshAfterCallback:!1,callback:function(){this.forms.showUpdatePopup()}}),t.DefineIcon("inputBack",{NAME:"arrow-left",SVG_KEY:"back"}),t.RegisterCommand("inputBack",{title:"Back",undo:!1,focus:!1,back:!0,refreshAfterCallback:!1,callback:function(){this.forms.back()}}),t.RegisterCommand("updateInput",{undo:!1,focus:!1,title:"Update",callback:function(){this.forms.updateInput()}})});