!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("froala-editor")):"function"==typeof define&&define.amd?define(["froala-editor"],t):t(e.FroalaEditor)}(this,function(e){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e,Object.assign(e.DEFAULTS,{wordDeniedTags:[],wordDeniedAttrs:[],wordAllowedStyleProps:["font-family","font-size","background","color","width","text-align","vertical-align","background-color","padding","margin","height","margin-top","margin-left","margin-right","margin-bottom","text-decoration","font-weight","font-style","text-indent","border","border-.*","line-height","list-style-type"],wordPasteModal:!0,wordPasteKeepFormatting:!0}),e.PLUGINS.wordPaste=function(t){var r,i,n=t.$,l="word_paste",a={};function o(r){var o=t.opts.wordAllowedStyleProps;r||(t.opts.wordAllowedStyleProps=[]),0===i.indexOf("<colgroup>")&&(i="<table>"+i+"</table>"),i=function(r,i){0<=r.indexOf("<html")&&(r=r.replace(/[.\s\S\w\W<>]*(<html[^>]*>[.\s\S\w\W<>]*<\/html>)[.\s\S\w\W<>]*/i,"$1")),function(e){for(var t=e.split("v:shape"),r=1;r<t.length;r++){var i=t[r],n=i.split(' id="')[1];if(n&&1<n.length){n=n.split('"')[0];var l=i.split(' o:spid="')[1];l&&1<l.length&&(l=l.split('"')[0],a[n]=l)}}}(r);var l=(new DOMParser).parseFromString(r,"text/html"),o=l.head,p=l.body,h=function(e){var t={},r=e.getElementsByTagName("style");if(r.length){var i=r[0].innerHTML.match(/[\S ]+\s+{[\s\S]+?}/gi);if(i)for(var n=0;n<i.length;n++){var l=i[n],a=l.replace(/([\S ]+\s+){[\s\S]+?}/gi,"$1"),o=l.replace(/[\S ]+\s+{([\s\S]+?)}/gi,"$1");a=a.replace(/^[\s]|[\s]$/gm,""),o=o.replace(/^[\s]|[\s]$/gm,""),a=a.replace(/\n|\r|\n\r/g,""),o=o.replace(/\n|\r|\n\r/g,"");for(var s=a.split(", "),d=0;d<s.length;d++)t[s[d]]=o}}return t}(o);d(p,function(t){if(t.nodeType===Node.TEXT_NODE&&/\n|\u00a0|\r/.test(t.data)){if(!/\S| /.test(t.data)&&!/[\u00a0]+/.test(t.data))return t.data===e.UNICODE_NBSP?(t.data="â€‹",!0):1===t.data.length&&10===t.data.charCodeAt(0)?(t.data=" ",!0):(s(t),!1);t.data=t.data.replace(/\n|\r/gi," ")}return!0}),d(p,function(e){return e.nodeType!==Node.ELEMENT_NODE||"V:IMAGEDATA"!==e.tagName&&"IMG"!==e.tagName||function(e,r){if(r){var i;if("IMG"===e.tagName){var l=e.getAttribute("src");if(!l||-1===l.indexOf("file://"))return;if(0===l.indexOf("file://")&&t.helpers.isURL(e.getAttribute("alt")))return void e.setAttribute("src",e.getAttribute("alt"));(i=a[e.getAttribute("v:shapes")])||(i=e.getAttribute("v:shapes"),e.parentNode&&e.parentNode.parentNode&&0<=e.parentNode.parentNode.innerHTML.indexOf("msEquation")&&(i=null))}else i=e.parentNode.getAttribute("o:spid");if(e.removeAttribute("height"),i){!function(e){m={},v(e,"i","\\shppict"),v(e,"s","\\shp{")}(r);var o=m[i.substring(7)];if(o){var s=function(e){for(var t=e.match(/[0-9a-f]{2}/gi),r=[],i=0;i<t.length;i++)r.push(String.fromCharCode(parseInt(t[i],16)));var n=r.join("");return btoa(n)}(o.image_hex),d="data:"+o.image_type+";base64,"+s;"IMG"===e.tagName?(e.src=d,e.setAttribute("data-fr-image-pasted",!0)):n(e.parentNode).before('<img data-fr-image-pasted="true" src="'+d+'" style="'+e.parentNode.getAttribute("style")+'">').remove()}}}}(e,i),!0});for(var C=p.querySelectorAll("ul > ul, ul > ol, ol > ul, ol > ol"),E=C.length-1;0<=E;E--)C[E].previousElementSibling&&"LI"===C[E].previousElementSibling.tagName&&C[E].previousElementSibling.appendChild(C[E]);d(p,function(e){if(e.nodeType===Node.TEXT_NODE)return e.data=e.data.replace(/<br>(\n|\r)/gi,"<br>"),!1;if(e.nodeType===Node.ELEMENT_NODE){if(f(e)){var t,r=e.parentNode,i=e.previousSibling,n=function e(t,r,i){var n,l,a,o,s,d,u=/[0-9a-zA-Z]./gi,p=!1,c=t.querySelector('span[style="mso-list:Ignore"]');if(c&&(p=p||u.test(c.textContent)),1==p){var h=c.textContent.trim().split(".")[0];"a"==h?d="lower-alpha;":"A"==h?d="upper-alpha;":"1"==h?d="decimal;":"i"==h?d="lower-roman;":"I"==h?d="upper-roman;":"o"==h&&(d="circle;"),d="list-style-type: "+d,s="ol"}else s="ul";for(var m=d?"<"+s+' style = "'+d+'">':"<"+s+">";t;){if(!f(t)){if(t.outerHTML&&0<t.outerHTML.indexOf("mso-bookmark")&&0==(t.textContent||"").length){t=t.nextElementSibling;continue}break}var v=t.getAttribute("style").replace(/\n/gi,"").replace(/.*level([0-9]+?).*/gi,"$1");if((i=i||v)<v)m+=(o=e(t,r,v)).el.outerHTML,t=o.currentNode;else{if(v<i)break;t.firstElementChild&&t.firstElementChild.firstElementChild&&t.firstElementChild.firstElementChild.firstChild&&(u.lastIndex=0,n=u.test(t.firstElementChild.firstElementChild.firstChild.data||t.firstElementChild.firstElementChild.firstChild.firstChild&&t.firstElementChild.firstElementChild.firstChild.firstChild.data||"")),a&&a.firstElementChild&&a.firstElementChild.firstElementChild&&a.firstElementChild.firstElementChild.firstChild&&(u.lastIndex=0,l=u.test(a.firstElementChild.firstElementChild.firstChild.data||a.firstElementChild.firstElementChild.firstChild.firstChild&&a.firstElementChild.firstElementChild.firstChild.firstChild.data||"")),void 0===l||l===n?m+="<li>"+g(t,r)+"</li>":(m+=(o=e(t,r,v)).el.outerHTML,t=o.currentNode);var b=t&&t.nextElementSibling;b&&(a=b.previousElementSibling),t&&t.parentNode&&t.parentNode.removeChild(t),t=b}}m+="</"+s+">";var C=document.createElement("div");return C.innerHTML=m,{el:C.firstElementChild,currentNode:t}}(e,h).el;return(t=i?i.nextSibling:r.firstChild)?r.insertBefore(n,t):r.appendChild(n),!1}return"FONT"===e.tagName&&h["."+e.getAttribute("class")]&&(e=u(e,"span")),b(e,h)}if(e.nodeType!==Node.COMMENT_NODE)return!0;if(-1<e.data.indexOf("[if !supportLineBreakNewLine]"))for(var l=e.nextSibling;l;)(l=e.nextSibling)&&s(l),l.data&&-1<l.data.indexOf("[endif]")&&(l=null);return s(e),!1}),d(p,function(e){if(e.nodeType===Node.ELEMENT_NODE){var t=e.tagName;if(!e.innerHTML&&-1===["BR","IMG"].indexOf(t)){for(var r=e.parentNode;r&&(s(e),!(e=r).innerHTML);)r=e.parentNode;return!1}!function(e){var t=e.getAttribute("style");if(t){(t=c(t))&&";"!==t.slice(-1)&&(t+=";");var r=t.match(/(^|\S+?):.+?;{1,1}/gi);if(r){for(var i={},n=0;n<r.length;n++){var l=r[n].split(":");2===l.length&&("text-align"===l[0]&&"SPAN"===e.tagName||(i[l[0]]=l[1]))}var a="";for(var o in i)if(i.hasOwnProperty(o)){if("font-size"===o&&"pt;"===i[o].slice(-3)){var s=null;try{s=parseFloat(i[o].slice(0,-3),10)}catch(e){s=null}s&&(s=Math.round(1.33*s),i[o]=s+"px;")}a+=o+":"+i[o]}a&&e.setAttribute("style",a)}}}(e)}return!0}),d(p,function(e){if(e&&"A"===e.nodeName&&""===e.href){for(var t=document.createDocumentFragment();e.firstChild;)t.appendChild(e.firstChild);e.parentNode.replaceChild(t,e)}return!0});var N=p.outerHTML,y=t.opts.htmlAllowedStyleProps;return t.opts.htmlAllowedStyleProps=t.opts.wordAllowedStyleProps,N=t.clean.html(N,t.opts.wordDeniedTags,t.opts.wordDeniedAttrs,!1),t.opts.htmlAllowedStyleProps=y,N}(i=i.replace(/<span[\n\r ]*style='mso-spacerun:yes'>([\r\n\u00a0 ]*)<\/span>/g,function(e,t){for(var r="",i=0;i++<t.length;)r+="&nbsp;";return r}),t.paste.getRtfClipboard());var p=t.doc.createElement("DIV");p.innerHTML=i,t.html.cleanBlankSpaces(p),i=p.innerHTML,i=(i=t.paste.cleanEmptyTagsAndDivs(i)).replace(/\u200b/g,""),t.modals.hide(l),t.paste.clean(i,!0,!0),t.opts.wordAllowedStyleProps=o}function s(e){e.parentNode&&e.parentNode.removeChild(e)}function d(e,t){if(t(e))for(var r=e.firstChild;r;){var i=r,n=r.previousSibling;r=r.nextSibling,d(i,t),i.previousSibling||i.nextSibling||i.parentNode||!r||n===r.previousSibling||!r.parentNode?i.previousSibling||i.nextSibling||i.parentNode||!r||r.previousSibling||r.nextSibling||r.parentNode||(n?r=n.nextSibling?n.nextSibling.nextSibling:null:e.firstChild&&(r=e.firstChild.nextSibling)):r=n?n.nextSibling:e.firstChild}}function f(e){if(!e.getAttribute("style")||!/mso-list:[\s]*l/gi.test(e.getAttribute("style").replace(/\n/gi,"")))return!1;try{if(!e.querySelector('[style="mso-list:Ignore"]'))return!!(e.outerHTML&&0<=e.outerHTML.indexOf("\x3c!--[if !supportLists]--\x3e"))}catch(e){return!1}return!0}function g(e,r){var i=e.cloneNode(!0);if(-1!==["H1","H2","H3","H4","H5","H6"].indexOf(e.tagName)){var n=document.createElement(e.tagName.toLowerCase());n.setAttribute("style",e.getAttribute("style")),n.innerHTML=i.innerHTML,i.innerHTML=n.outerHTML}d(i,function(e){if(e.nodeType==Node.COMMENT_NODE&&(t.browser.msie||t.browser.safari||t.browser.edge))try{if("[if !supportLists]"===e.data){for(e=e.nextSibling;e&&e.nodeType!==Node.COMMENT_NODE;){var i=e.nextSibling;e.parentNode.removeChild(e),e=i}e&&e.nodeType==Node.COMMENT_NODE&&e.parentNode.removeChild(e)}}catch(e){}return e.nodeType===Node.ELEMENT_NODE&&("mso-list:Ignore"===e.getAttribute("style")&&e.parentNode.removeChild(e),e.setAttribute("style",function(e){var t="",r=e.getAttribute("style");return r&&["line-height","font-family","font-size","color","background"].forEach(function(e){var i=r.match(new RegExp(e+":.*;"));i&&(t+=i[0]+";")}),t}(e)),b(e,r)),!0});var l=i.innerHTML;return l.replace(/<!--[\s\S]*?-->/gi,"")}function u(e,t){for(var r=document.createElement(t),i=0;i<e.attributes.length;i++){var n=e.attributes[i].name;r.setAttribute(n,e.getAttribute(n))}return r.innerHTML=e.innerHTML,e.parentNode.replaceChild(r,e),r}function p(e){var t=e.getAttribute("align");t&&(e.style["text-align"]=t,e.removeAttribute("align"))}function c(e){return e.replace(/\n|\r|\n\r|&quot;/g,"")}function h(e,t,r){if(t){var i=e.getAttribute("style");i&&";"!==i.slice(-1)&&(i+=";"),t&&";"!==t.slice(-1)&&(t+=";"),t=t.replace(/\n/gi,"");var n;n=r?(i||"")+t:t+(i||""),e.setAttribute("style",n)}}var m=null;function v(e,t,r){for(var i=e.split(r),n=1;n<i.length;n++){var l=i[n];if(1<(l=l.split("shplid")).length){l=l[1];for(var a="",o=0;o<l.length&&"\\"!==l[o]&&"{"!==l[o]&&" "!==l[o]&&"\r"!==l[o]&&"\n"!==l[o];)a+=l[o],o++;var s=l.split("bliptag");if(s&&s.length<2)continue;var d=null;if(-1!==s[0].indexOf("pngblip")?d="image/png":-1!==s[0].indexOf("jpegblip")&&(d="image/jpeg"),!d)continue;var f=s[1].split("}");if(f&&f.length<2)continue;var g=void 0;if(2<f.length&&-1!==f[0].indexOf("blipuid"))g=f[1].split(" ");else{if((g=f[0].split(" "))&&g.length<2)continue;g.shift()}var u=g.join("");m[t+a]={image_hex:u,image_type:d}}}}function b(r,i){var n=r.tagName,l=n.toLowerCase();if(r.firstElementChild&&("I"===r.firstElementChild.tagName?u(r.firstElementChild,"em"):"B"===r.firstElementChild.tagName&&u(r.firstElementChild,"strong")),-1!==["SCRIPT","APPLET","EMBED","NOFRAMES","NOSCRIPT"].indexOf(n))return s(r),!1;for(var a=["META","LINK","XML","ST1:","O:","W:","FONT"],o=0;o<a.length;o++)if(-1!==n.indexOf(a[o]))return r.innerHTML&&(r.outerHTML=r.innerHTML),s(r),!1;if("TD"!==n){var d=r.getAttribute("class")||"MsoNormal";if(i&&d){for(var g=(d=c(d)).split(" "),m=0;m<g.length;m++){var v=[],b="."+g[m];v.push(b),b=l+b,v.push(b);for(var C=0;C<v.length;C++)i[v[C]]&&h(r,i[v[C]])}r.removeAttribute("class")}i&&i[l]&&h(r,i[l])}if(-1!==["P","H1","H2","H3","H4","H5","H6","PRE"].indexOf(n)){var E=r.getAttribute("class");if(E&&(i&&i[n.toLowerCase()+"."+E]&&h(r,i[n.toLowerCase()+"."+E]),-1!==E.toLowerCase().indexOf("mso"))){var N=c(E);(N=N.replace(/[0-9a-z-_]*mso[0-9a-z-_]*/gi,""))?r.setAttribute("class",N):r.removeAttribute("class")}var y=r.getAttribute("style");if(y){var A=y.match(/text-align:.+?[; "]{1,1}/gi);A&&A[A.length-1].replace(/(text-align:.+?[; "]{1,1})/gi,"$1")}p(r)}if("TR"===n&&function(r,i){t.node.clearAttributes(r);for(var n=r.firstElementChild,l=0,a=!1,o=null;n;){n.firstElementChild&&-1!==n.firstElementChild.tagName.indexOf("W:")&&(n.innerHTML=n.firstElementChild.innerHTML),(o=n.getAttribute("width"))||a||(a=!0),l+=parseInt(o,10),(!n.firstChild||n.firstChild&&n.firstChild.data===e.UNICODE_NBSP)&&(n.firstChild&&s(n.firstChild),n.innerHTML="<br>");for(var d=n.firstElementChild,g=1===n.children.length;d;)"P"!==d.tagName||f(d)||g&&p(d),d=d.nextElementSibling;if(i){var u=n.getAttribute("class");if(u){var m=(u=c(u)).match(/xl[0-9]+/gi);if(m){var v="."+m[0];i[v]&&h(n,i[v])}}i.td&&h(n,i.td)}var b=n.getAttribute("style");b&&(b=c(b))&&";"!==b.slice(-1)&&(b+=";");var C=n.getAttribute("valign");if(!C&&b){var E=b.match(/vertical-align:.+?[; "]{1,1}/gi);E&&(C=E[E.length-1].replace(/vertical-align:(.+?)[; "]{1,1}/gi,"$1"))}var N=null;if(b){var y=b.match(/text-align:.+?[; "]{1,1}/gi);y&&(N=y[y.length-1].replace(/text-align:(.+?)[; "]{1,1}/gi,"$1")),"general"===N&&(N=null)}var A=null;if(b){var x=b.match(/background:.+?[; "]{1,1}/gi);x&&(A=x[x.length-1].replace(/background:(.+?)[; "]{1,1}/gi,"$1"))}var T=n.getAttribute("colspan"),w=n.getAttribute("rowspan");T&&n.setAttribute("colspan",T),w&&n.setAttribute("rowspan",w),C&&(n.style["vertical-align"]=C),N&&(n.style["text-align"]=N),A&&(n.style["background-color"]=A),o&&n.setAttribute("width",o),n=n.nextElementSibling}for(n=r.firstElementChild;n;)o=n.getAttribute("width"),a?n.removeAttribute("width"):n.setAttribute("width",100*parseInt(o,10)/l+"%"),n=n.nextElementSibling}(r,i),"A"!==n||r.attributes.getNamedItem("href")||r.attributes.getNamedItem("name")||!r.innerHTML||(r.outerHTML=r.innerHTML),"A"==n&&r.getAttribute("href")&&r.querySelector("img"))for(var x=r.querySelectorAll("span"),T=0;T<x.length;T++)x[T].innerText||(x[T].outerHTML=x[T].innerHTML);if("TD"!==n&&"TH"!==n||r.innerHTML||(r.innerHTML="<br>"),"TABLE"===n&&(r.style.width=r.style.width),r.getAttribute("lang")&&r.removeAttribute("lang"),r.getAttribute("style")&&-1!==r.getAttribute("style").toLowerCase().indexOf("mso")){var w=c(r.getAttribute("style"));(w=w.replace(/[0-9a-z-_]*mso[0-9a-z-_]*:.+?(;{1,1}|$)/gi,""))?r.setAttribute("style",w):r.removeAttribute("style")}return!0}return{_init:function(){t.events.on("paste.wordPaste",function(e){return i=e,t.opts.wordPasteModal?function(){if(!r){var e='<h4><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 74.95 73.23" style="height: 25px; vertical-align: text-bottom; margin-right: 5px; display: inline-block"><defs><style>.a{fill:#2a5699;}.b{fill:#fff;}</style></defs><path class="a" d="M615.15,827.22h5.09V834c9.11.05,18.21-.09,27.32.05a2.93,2.93,0,0,1,3.29,3.25c.14,16.77,0,33.56.09,50.33-.09,1.72.17,3.63-.83,5.15-1.24.89-2.85.78-4.3.84-8.52,0-17,0-25.56,0v6.81h-5.32c-13-2.37-26-4.54-38.94-6.81q0-29.8,0-59.59c13.05-2.28,26.11-4.5,39.17-6.83Z" transform="translate(-575.97 -827.22)"/><path class="b" d="M620.24,836.59h28.1v54.49h-28.1v-6.81h22.14v-3.41H620.24v-4.26h22.14V873.2H620.24v-4.26h22.14v-3.41H620.24v-4.26h22.14v-3.41H620.24v-4.26h22.14v-3.41H620.24V846h22.14v-3.41H620.24Zm-26.67,15c1.62-.09,3.24-.16,4.85-.25,1.13,5.75,2.29,11.49,3.52,17.21,1-5.91,2-11.8,3.06-17.7,1.7-.06,3.41-.15,5.1-.26-1.92,8.25-3.61,16.57-5.71,24.77-1.42.74-3.55,0-5.24.09-1.13-5.64-2.45-11.24-3.47-16.9-1,5.5-2.29,10.95-3.43,16.42q-2.45-.13-4.92-.3c-1.41-7.49-3.07-14.93-4.39-22.44l4.38-.18c.88,5.42,1.87,10.82,2.64,16.25,1.2-5.57,2.43-11.14,3.62-16.71Z" transform="translate(-575.97 -827.22)"/></svg> '+t.language.translate("Word Paste Detected")+"</h4>",i=function(){var e='<div class="fr-word-paste-modal" style="padding: 20px 20px 10px 20px;">';return e+='<p style="text-align: left;">'+t.language.translate("The pasted content is coming from a Microsoft Word document. Do you want to keep the format or clean it up?")+"</p>",(e+='<div style="text-align: right; margin-top: 50px;"><button class="fr-remove-word fr-command">'+t.language.translate("Clean")+'</button> <button class="fr-keep-word fr-command">'+t.language.translate("Keep")+"</button></div>")+"</div>"}(),a=t.modals.create(l,e,i),o=a.$body;r=a.$modal,a.$modal.addClass("fr-middle"),t.events.bindClick(o,"button.fr-remove-word",function(){(r.data("instance")||t).wordPaste.clean()}),t.events.bindClick(o,"button.fr-keep-word",function(){(r.data("instance")||t).wordPaste.clean(!0)}),t.events.$on(n(t.o_win),"resize",function(){t.modals.resize(l)})}t.modals.show(l),t.modals.resize(l)}():o(t.opts.wordPasteKeepFormatting),!1})},clean:o}}});