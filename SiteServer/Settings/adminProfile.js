var $url="/pages/settings/adminProfile",$pageTypeAdmin="admin",$pageTypeUser="user",data={pageLoad:!1,pageAlert:null,pageType:utils.getQueryString("pageType"),userId:parseInt(utils.getQueryString("userId")||"0"),adminInfo:null,password:null,confirmPassword:null,uploadUrl:null,files:[]},methods={getConfig:function(){var t=this;$api.get($url+"?userId="+t.userId).then(function(e){var a=e.data;t.adminInfo=a.value,t.uploadUrl=apiUrl+"/pages/settings/adminProfile/upload?adminToken="+a.adminToken+"&userId="+t.userId}).catch(function(e){t.pageAlert=utils.getPageAlert(e)}).then(function(){t.pageLoad=!0})},inputAvatar(t,e){Boolean(t)===Boolean(e)&&e.error===t.error||this.$refs.avatar.active||(this.$refs.avatar.active=!0),t&&e&&t.xhr&&t.success!==e.success&&(this.adminInfo.avatarUrl=t.response.value)},submit:function(){var t=this;pageUtils.loading(!0),$api.post($url+"?userId="+t.userId,_.assign({},t.adminInfo,{password:t.password})).then(function(e){e.data;swal({toast:!0,type:"success",title:"管理员资料保存成功！",showConfirmButton:!1,timer:3e3}).then(function(){t.pageType==$pageTypeAdmin?t.btnReturnClick():top.location.reload(!0)})}).catch(function(e){t.pageAlert=utils.getPageAlert(e)}).then(function(){pageUtils.loading(!1)})},btnSubmitClick:function(){this.pageAlert=null;var t=this;this.adminInfo.id>0&&this.password!=this.confirmPassword||this.$validator.validate().then(function(e){e&&t.submit()})},btnReturnClick:function(){location.href="admin.cshtml"}};new Vue({el:"#main",data:data,components:{FileUpload:VueUploadComponent},methods:methods,created:function(){this.getConfig()}});